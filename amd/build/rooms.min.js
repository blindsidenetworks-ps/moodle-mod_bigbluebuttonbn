function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("mod_bigbluebuttonbn/rooms",["exports","./repository","core/notification","core/config","core/templates"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.setupWindowAutoClose=a.initActions=a.init=void 0;b=h(b);d=f(d);e=f(e);function f(a){return a&&a.__esModule?a:{default:a}}function g(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;g=function(){return a};return a}function h(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=g();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}a.init=function init(a){var d=document.querySelector("a[href*=completion_validate]");if(d){d.addEventListener("click",function(){b.completionValidate(a).catch(c.exception)})}};a.initActions=function initActions(){var a=document.querySelectorAll(".bbb-btn-action");a.forEach(function(a){a.addEventListener("click",function(a){var e=a.target,f=e.id,g=e.dataset.bbbId;if("join_button_input"===f){var h=0,l=e.dataset.cmId,m=new URL(d.default.wwwroot+"/mod/bigbluebuttonbn/bbb_view.php"),n=document.querySelectorAll(".groupselector select[name=\"group\"]");if(n.length){var o=n[0];h=o[o.selectedIndex].value}m.searchParams.append("action","join");m.searchParams.append("id",l);m.searchParams.append("bn",g);if(h){m.searchParams.append("group",h)}else{var p=e.dataset.groupId;if(p){m.searchParams.append("group",h)}}k(m.toString())}if("end_button_input"===f){var q=e.dataset.meetingId;b.endMeeting({bigbluebuttonbnid:g,meetingid:q}).then(function(){j();i(!0)}).catch(c.exception)}})})};a.setupWindowAutoClose=function setupWindowAutoClose(){window.onunload=function(){opener.setTimeout(function(){j()},5e3);window.close()};window.close()};var j=function(a){var d=document.getElementById("bbb-room-view"),f=d.dataset.bbbId,g=d.dataset.meetingId;a="undefined"==typeof a?!1:a;return b.meetingInfo({bigbluebuttonbnid:f,meetingid:g,updatecache:a}).then(function(a){e.default.renderForPromise("mod_bigbluebuttonbn/room_view",a).then(function(a){e.default.replaceNodeContents(d,a.html,a.js)}).catch(c.exception);return a}).catch(c.exception)},k=function(a){i();a.searchParams.append('usernamecustom', document.getElementById('nameinputfield').value);window.open(a)};function i(a){if("undefined"==typeof i.timeoutint){i.timeoutint=0}if("undefined"==typeof i.updatecount){i.updatecount=0}if("undefined"==typeof i.currentfactor){i.currentfactor=1}if(a){if(i.timeoutint){clearInterval(i.timeoutint);i.timeoutint=0;i.updatecount=0;i.currentfactor=1}}else{i.timeoutint=setInterval(function(){if(0==i.updatecount%i.currentfactor){j(!0);if(i.currentfactor>=10){i.currentfactor=1}else{i.currentfactor++}}i.updatecount++},1e3)}}});
//# sourceMappingURL=rooms.min.js.map
