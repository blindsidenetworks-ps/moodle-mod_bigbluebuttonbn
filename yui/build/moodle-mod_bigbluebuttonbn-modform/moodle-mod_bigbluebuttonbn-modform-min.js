YUI.add("moodle-mod_bigbluebuttonbn-modform",function(o,t){M.mod_bigbluebuttonbn=M.mod_bigbluebuttonbn||{},M.mod_bigbluebuttonbn.modform={bigbluebuttonbn:{},strings:{},init:function(t){this.bigbluebuttonbn=t,this.strings={as:M.util.get_string("mod_form_field_participant_list_text_as","bigbluebuttonbn"),viewer:M.util.get_string("mod_form_field_participant_bbb_role_viewer","bigbluebuttonbn"),moderator:M.util.get_string("mod_form_field_participant_bbb_role_moderator","bigbluebuttonbn"),remove:M.util.get_string("mod_form_field_participant_list_action_remove","bigbluebuttonbn")},this.updateInstanceTypeProfile(),this.participantListInit()},updateInstanceTypeProfile:function(){var t,i;t=o.one("#id_type"),i=this.bigbluebuttonbn.instanceTypeDefault,null!==t&&(i=t.get("value")),this.applyInstanceTypeProfile(i)},applyInstanceTypeProfile:function(t){var i=this.isFeatureEnabled(t,"all");this.showFieldset("id_room",i||this.isFeatureEnabled(t,"showroom")),this.showInput("id_record",i||this.isFeatureEnabled(t,"showroom")),this.showFieldset("id_recordings",i||this.isFeatureEnabled(t,"showrecordings")),this.showInput("id_recordings_imported",i||this.isFeatureEnabled(t,"showrecordings")),this.showFieldset("id_preuploadpresentation",i||this.isFeatureEnabled(t,"preuploadpresentation")),this.showFieldset("id_permissions",i||this.isFeatureEnabled(t,"permissions")),this.showFieldset("id_schedule",i||this.isFeatureEnabled(t,"schedule")),this.showFieldset("id_modstandardelshdr",i||this.isFeatureEnabled(t,"modstandardelshdr")),this.showFieldset("id_availabilityconditionsheader",i||this.isFeatureEnabled(t,"availabilityconditionsheader")),this.showFieldset("id_tagshdr",i||this.isFeatureEnabled(t,"tagshdr")),this.showFieldset("id_competenciessection",i||this.isFeatureEnabled(t,"competenciessection")),this.showFormGroup("completionattendancegroup",i||this.isFeatureEnabled(t,"completionattendance")),this.showFormGroup("completionengagementgroup",i||this.isFeatureEnabled(t,"completionengagement"))},isFeatureEnabled:function(t,i){return-1!=this.bigbluebuttonbn.instanceTypeProfiles[t].features.indexOf(i)},showFieldset:function(t,i){var e=o.one("#"+t);e&&(i?e.setStyle("display","block"):e.setStyle("display","none"))},showInput:function(t,i){var e,n=o.one("#"+t);n&&(e=n.ancestor("div").ancestor("div"),i?e.setStyle("display","block"):e.setStyle("display","none"))},showFormGroup:function(t,i){var e=o.one("#fgroup_id_"+t);e&&(i?e.removeClass("hidden"):e.addClass("hidden"))},participantSelectionSet:function(){var t,i,e,n;for(this.selectClear("bigbluebuttonbn_participant_selection"),t=document.getElementById("bigbluebuttonbn_participant_selection_type"),i=0;i<t.options.length;i++)if(t.options[i].selected){for(n in e=this.bigbluebuttonbn.participantData[t.options[i].value].children)e.hasOwnProperty(n)&&this.selectAddOption("bigbluebuttonbn_participant_selection",e[n].name,e[n].id);"all"===t.options[i].value?(this.selectAddOption("bigbluebuttonbn_participant_selection","---------------","all"),this.selectDisable("bigbluebuttonbn_participant_selection")):this.selectEnable("bigbluebuttonbn_participant_selection")}},participantListInit:function(){var t,i,e,n,o;for(this.participantListClear(),o=0;o<this.bigbluebuttonbn.participantList.length;o++)t=this.bigbluebuttonbn.participantList[o].selectiontype,i=this.bigbluebuttonbn.participantList[o].selectionid,e=this.bigbluebuttonbn.participantList[o].role,n=this.bigbluebuttonbn.participantData[t],"all"==t||"undefined"!=typeof n.children[i]?this.participantAddToForm(t,i,e,0<o):this.participantRemoveFromMemory(t,i);this.participantListUpdate()},participantListClear:function(){var t,i=document.getElementById("participant_list_table"),e=i.getElementsByTagName("tr");for(t=e.length;0<t;t--)i.deleteRow(0)},participantListUpdate:function(){document.getElementsByName("participants")[0].value=JSON.stringify(this.bigbluebuttonbn.participantList).replace(/"/g,"&quot;")},participantRemove:function(t,i){this.participantRemoveFromMemory(t,i),this.participantRemoveFromForm(t,i),this.participantListUpdate()},participantRemoveFromMemory:function(t,i){var e,n=""===i?null:i;for(e=0;e<this.bigbluebuttonbn.participantList.length;e++)this.bigbluebuttonbn.participantList[e].selectiontype==t&&this.bigbluebuttonbn.participantList[e].selectionid==n&&this.bigbluebuttonbn.participantList.splice(e,1)},participantRemoveFromForm:function(t,i){var e,n="participant_list_tr_"+t+"-"+i,o=document.getElementById("participant_list_table");for(e=0;e<o.rows.length;e++)o.rows[e].id==n&&o.deleteRow(e)},participantAdd:function(){var t,i=document.getElementById("bigbluebuttonbn_participant_selection_type"),e=document.getElementById("bigbluebuttonbn_participant_selection");for(t=0;t<this.bigbluebuttonbn.participantList.length;t++)if(this.bigbluebuttonbn.participantList[t].selectiontype==i.value&&this.bigbluebuttonbn.participantList[t].selectionid==e.value)return;this.participantAddToMemory(i.value,e.value),this.participantAddToForm(i.value,e.value,"viewer",!0),this.participantListUpdate()},participantAddToMemory:function(t,i){this.bigbluebuttonbn.participantList.push({selectiontype:t,selectionid:i,role:"viewer"})},participantAddToForm:function(t,i,e,n){var o,s,a,l,r,b,p,u,c,d,h;for((u=(o=document.getElementById("participant_list_table")).insertRow(o.rows.length)).id="participant_list_tr_"+t+"-"+i,(c=u.insertCell(0)).width="125px",c.innerHTML="<b><i>"+this.bigbluebuttonbn.participantData[t].name,c.innerHTML+=("all"!==t?":&nbsp;":"")+"</i></b>",(d=u.insertCell(1)).innerHTML="","all"!==t&&(d.innerHTML=this.bigbluebuttonbn.participantData[t].children[i].name),s="&nbsp;<i>"+this.strings.as+"</i>&nbsp;",s+='<select id="participant_list_role_'+t+"-"+i+'"',s+=" onchange=\"M.mod_bigbluebuttonbn.modform.participantListRoleUpdate('",s+=t+"', '"+i,s+='\'); return 0;" class="select custom-select">',b=["viewer","moderator"],p=0;p<b.length;p++)a="",b[p]===e&&(a=' selected="selected"'),s+='<option value="'+b[p]+'"'+a+">"+this.strings[b[p]]+"</option>"
;s+="</select>",u.insertCell(2).innerHTML=s,(h=u.insertCell(3)).width="20px",l=this.strings.remove,r="btn btn-secondary btn-sm",this.bigbluebuttonbn.iconsEnabled&&(l=this.bigbluebuttonbn.pixIconDelete,r="btn btn-link"),s="",n&&(s='<a class="'+r+'" onclick="M.mod_bigbluebuttonbn.modform.participantRemove(\'',s+=t+"', '"+i,s+='\'); return 0;" title="'+this.strings.remove+'">'+l+"</a>"),h.innerHTML=s},participantListRoleUpdate:function(t,i){var e,n=document.getElementById("participant_list_role_"+t+"-"+i);for(e=0;e<this.bigbluebuttonbn.participantList.length;e++)this.bigbluebuttonbn.participantList[e].selectiontype==t&&this.bigbluebuttonbn.participantList[e].selectionid==(""===i?null:i)&&(this.bigbluebuttonbn.participantList[e].role=n.value);this.participantListUpdate()},selectClear:function(t){for(var i=document.getElementById(t);0<i.length;)i.remove(i.length-1)},selectEnable:function(t){document.getElementById(t).disabled=!1},selectDisable:function(t){document.getElementById(t).disabled=!0},selectAddOption:function(t,i,e){var n=document.getElementById(t),o=document.createElement("option");o.text=i,o.value=e,n.add(o,o.length)}}},"@VERSION@",{requires:["base","node"]});