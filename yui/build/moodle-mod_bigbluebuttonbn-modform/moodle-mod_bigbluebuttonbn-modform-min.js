YUI.add("moodle-mod_bigbluebuttonbn-modform",function(e,t){M.mod_bigbluebuttonbn=M.mod_bigbluebuttonbn||{},M.mod_bigbluebuttonbn.modform={bigbluebuttonbn:{},strings:{},init:function(t){this.bigbluebuttonbn=t,this.strings={as:M.util.get_string("mod_form_field_participant_list_text_as","bigbluebuttonbn"),viewer:M.util.get_string("mod_form_field_participant_bbb_role_viewer","bigbluebuttonbn"),moderator:M.util.get_string("mod_form_field_participant_bbb_role_moderator","bigbluebuttonbn"),remove:M.util.get_string("mod_form_field_participant_list_action_remove","bigbluebuttonbn")},this.updateInstanceTypeProfile(),this.participantListInit()},updateInstanceTypeProfile:function(){var t=e.one("#id_type"),i=this.bigbluebuttonbn.instanceTypeDefault;null!==t&&(i=t.get("value")),this.applyInstanceTypeProfile(i)},applyInstanceTypeProfile:function(t){var i=this.isFeatureEnabled(t,"all");this.showFieldset("id_room",i||this.isFeatureEnabled(t,"showroom")),this.showInput("id_record",i||this.isFeatureEnabled(t,"showroom")),this.showFieldset("id_recordings",i||this.isFeatureEnabled(t,"showrecordings")),this.showInput("id_recordings_imported",i||this.isFeatureEnabled(t,"showrecordings")),this.showFieldset("id_preuploadpresentation",i||this.isFeatureEnabled(t,"preuploadpresentation")),this.showFieldset("id_permissions",i||this.isFeatureEnabled(t,"permissions")),this.showFieldset("id_schedule",i||this.isFeatureEnabled(t,"schedule")),this.showFieldset("id_modstandardelshdr",i||this.isFeatureEnabled(t,"modstandardelshdr")),this.showFieldset("id_availabilityconditionsheader",i||this.isFeatureEnabled(t,"availabilityconditionsheader")),this.showFieldset("id_tagshdr",i||this.isFeatureEnabled(t,"tagshdr")),this.showFieldset("id_competenciessection",i||this.isFeatureEnabled(t,"competenciessection")),this.showFormGroup("completionattendancegroup",i||this.isFeatureEnabled(t,"completionattendance")),this.showFormGroup("completionengagementgroup",i||this.isFeatureEnabled(t,"completionengagement"))},isFeatureEnabled:function(t,i){return-1!=this.bigbluebuttonbn.instanceTypeProfiles[t].features.indexOf(i)},showFieldset:function(t,i){t=e.one("#"+t);t&&(i?t.setStyle("display","block"):t.setStyle("display","none"))},showInput:function(t,i){var t=e.one("#"+t);t&&(t=t.ancestor("div").ancestor("div"),i?t.setStyle("display","block"):t.setStyle("display","none"))},showFormGroup:function(t,i){t=e.one("#fgroup_id_"+t);t&&(i?t.removeClass("hidden"):t.addClass("hidden"))},participantSelectionSet:function(){var t,i,e,n;for(this.selectClear("bigbluebuttonbn_participant_selection"),t=document.getElementById("bigbluebuttonbn_participant_selection_type"),i=0;i<t.options.length;i++)if(t.options[i].selected){for(n in e=this.bigbluebuttonbn.participantData[t.options[i].value].children)e.hasOwnProperty(n)&&this.selectAddOption("bigbluebuttonbn_participant_selection",e[n].name,e[n].id);"all"===t.options[i].value?(this.selectAddOption("bigbluebuttonbn_participant_selection","---------------","all"),this.selectDisable("bigbluebuttonbn_participant_selection")):this.selectEnable("bigbluebuttonbn_participant_selection")}},participantListInit:function(){var t,i,e,n,o;for(this.participantListClear(),o=0;o<this.bigbluebuttonbn.participantList.length;o++)t=this.bigbluebuttonbn.participantList[o].selectiontype,i=this.bigbluebuttonbn.participantList[o].selectionid,e=this.bigbluebuttonbn.participantList[o].role,n=this.bigbluebuttonbn.participantData[t],"all"==t||"undefined"!=typeof n.children[i]?this.participantAddToForm(t,i,e,0<o):this.participantRemoveFromMemory(t,i);this.participantListUpdate()},participantListClear:function(){for(var t=document.getElementById("participant_list_table"),i=t.getElementsByTagName("tr"),e=i.length;0<e;e--)t.deleteRow(0)},participantListUpdate:function(){document.getElementsByName("participants")[0].value=JSON.stringify(this.bigbluebuttonbn.participantList).replace(/"/g,"&quot;")},participantRemove:function(t,i){this.participantRemoveFromMemory(t,i),this.participantRemoveFromForm(t,i),this.participantListUpdate()},participantRemoveFromMemory:function(t,i){for(var e=""===i?null:i,n=0;n<this.bigbluebuttonbn.participantList.length;n++)this.bigbluebuttonbn.participantList[n].selectiontype==t&&this.bigbluebuttonbn.participantList[n].selectionid==e&&this.bigbluebuttonbn.participantList.splice(n,1)},participantRemoveFromForm:function(t,i){for(var e="participant_list_tr_"+t+"-"+i,n=document.getElementById("participant_list_table"),o=0;o<n.rows.length;o++)n.rows[o].id==e&&n.deleteRow(o)},participantAdd:function(){for(var t=document.getElementById("bigbluebuttonbn_participant_selection_type"),i=document.getElementById("bigbluebuttonbn_participant_selection"),e=0;e<this.bigbluebuttonbn.participantList.length;e++)if(this.bigbluebuttonbn.participantList[e].selectiontype==t.value&&this.bigbluebuttonbn.participantList[e].selectionid==i.value)return;this.participantAddToMemory(t.value,i.value),this.participantAddToForm(t.value,i.value,"viewer",!0),this.participantListUpdate()},participantAddToMemory:function(t,i){this.bigbluebuttonbn.participantList.push({selectiontype:t,selectionid:i,role:"viewer"})},participantAddToForm:function(t,i,e,p){var n,o,s,a,l,r,b=document.getElementById("participant_list_table"),b=b.insertRow(b.rows.length);for(b.id="participant_list_tr_"+t+"-"+i,(r=b.insertCell(0)).width="125px",r.innerHTML="<b><i>"+this.bigbluebuttonbn.participantData[t].name,r.innerHTML+=("all"!==t?":&nbsp;":"")+"</i></b>",(r=b.insertCell(1)).innerHTML="","all"!==t&&(r.innerHTML=this.bigbluebuttonbn.participantData[t].children[i].name),n=(n=(n="&nbsp;<i>"+this.strings.as+"</i>&nbsp;")+('<select id="participant_list_role_'+t+"-"+i+'"')+" onchange=\"M.mod_bigbluebuttonbn.modform.participantListRoleUpdate('")+(t+"', '"+i)+'\'); return 0;" class="select custom-select">',a=["viewer","moderator"],l=0;l<a.length;l++)o="",n+='<option value="'+a[l]+'"'+(o=a[l]===e?' selected="selected"':o)+">"+this.strings[a[l]]+"</option>";n+="</select>",b.insertCell(2
).innerHTML=n,(r=b.insertCell(3)).width="20px",b=this.strings.remove,s="btn btn-secondary btn-sm",this.bigbluebuttonbn.iconsEnabled&&(b=this.bigbluebuttonbn.pixIconDelete,s="btn btn-link"),n="",p&&(n=(n='<a class="'+s+'" onclick="M.mod_bigbluebuttonbn.modform.participantRemove(\'')+t+"', '"+i+'\'); return 0;" title="'+this.strings.remove+'">'+b+"</a>"),r.innerHTML=n},participantListRoleUpdate:function(t,i){for(var e=document.getElementById("participant_list_role_"+t+"-"+i),n=0;n<this.bigbluebuttonbn.participantList.length;n++)this.bigbluebuttonbn.participantList[n].selectiontype==t&&this.bigbluebuttonbn.participantList[n].selectionid==(""===i?null:i)&&(this.bigbluebuttonbn.participantList[n].role=e.value);this.participantListUpdate()},selectClear:function(t){for(var i=document.getElementById(t);0<i.length;)i.remove(i.length-1)},selectEnable:function(t){document.getElementById(t).disabled=!1},selectDisable:function(t){document.getElementById(t).disabled=!0},selectAddOption:function(t,i,e){var t=document.getElementById(t),n=document.createElement("option");n.text=i,n.value=e,t.add(n,n.length)}}},"@VERSION@",{requires:["base","node"]});