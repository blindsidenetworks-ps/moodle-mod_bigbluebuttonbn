YUI.add("moodle-mod_bigbluebuttonbn-modform",function(e,t){M.mod_bigbluebuttonbn=M.mod_bigbluebuttonbn||{},M.mod_bigbluebuttonbn.modform={bigbluebuttonbn:{},strings:{},init:function(e){this.bigbluebuttonbn=e,this.strings={as:M.util.get_string("mod_form_field_participant_list_text_as","bigbluebuttonbn"),viewer:M.util.get_string("mod_form_field_participant_bbb_role_viewer","bigbluebuttonbn"),moderator:M.util.get_string("mod_form_field_participant_bbb_role_moderator","bigbluebuttonbn"),remove:M.util.get_string("mod_form_field_participant_list_action_remove","bigbluebuttonbn")},this.updateInstanceTypeProfile(),this.participantListInit()},updateInstanceTypeProfile:function(){var t,n;t=e.one("#id_type"),n=this.bigbluebuttonbn.instanceTypeDefault,t!==null&&(n=t.get("value")),this.applyInstanceTypeProfile(n)},applyInstanceTypeProfile:function(e){var t=this.isFeatureEnabled(e,"all");this.showFieldset("id_room",t||this.isFeatureEnabled(e,"showroom")),this.showInput("id_record",t||this.isFeatureEnabled(e,"showroom")),this.showFieldset("id_recordings",t||this.isFeatureEnabled(e,"showrecordings")),this.showInput("id_recordings_imported",t||this.isFeatureEnabled(e,"showrecordings")),this.showFieldset("id_preuploadpresentation",t||this.isFeatureEnabled(e,"preuploadpresentation")),this.showFieldset("id_permissions",t||this.isFeatureEnabled(e,"permissions")),this.showFieldset("id_schedule",t||this.isFeatureEnabled(e,"schedule")),this.showFieldset("id_modstandardelshdr",t||this.isFeatureEnabled(e,"modstandardelshdr")),this.showFieldset("id_availabilityconditionsheader",t||this.isFeatureEnabled(e,"availabilityconditionsheader")),this.showFieldset("id_tagshdr",t||this.isFeatureEnabled(e,"tagshdr")),this.showFieldset("id_competenciessection",t||this.isFeatureEnabled(e,"competenciessection")),this.showFormGroup("completionattendancegroup",t||this.isFeatureEnabled(e,"completionattendance")),this.showFormGroup("completionengagementgroup",t||this.isFeatureEnabled(e,"completionengagement"))},isFeatureEnabled:function(e,t){var n=this.bigbluebuttonbn.instanceTypeProfiles[e].features;return n.indexOf(t)!=-1},showFieldset:function(t,n){var r=e.one("#"+t);if(!r)return;if(n){r.setStyle("display","block");return}r.setStyle("display","none")},showInput:function(t,n){var r=e.one("#"+t);if(!r)return;var i=r.ancestor("div").ancestor("div");if(n){i.setStyle("display","block");return}i.setStyle("display","none")},showFormGroup:function(t,n){var r=e.one("#fgroup_id_"+t);if(!r)return;if(n){r.removeClass("hidden");return}r.addClass("hidden")},participantSelectionSet:function(){this.selectClear("bigbluebuttonbn_participant_selection");var e=document.getElementById("bigbluebuttonbn_participant_selection_type");for(var t=0;t<e.options.length;t++)if(e.options[t].selected){var n=this.bigbluebuttonbn.participantData[e.options[t].value].children;for(var r in n)n.hasOwnProperty(r)&&this.selectAddOption("bigbluebuttonbn_participant_selection",n[r].name,n[r].id);e.options[t].value==="all"?(this.selectAddOption("bigbluebuttonbn_participant_selection","---------------","all"),this.selectDisable("bigbluebuttonbn_participant_selection")):this.selectEnable("bigbluebuttonbn_participant_selection")}},participantListInit:function(){var e,t,n,r;this.participantListClear();for(var i=0;i<this.bigbluebuttonbn.participantList.length;i++){e=this.bigbluebuttonbn.participantList[i].selectiontype,t=this.bigbluebuttonbn.participantList[i].selectionid,n=this.bigbluebuttonbn.participantList[i].role,r=this.bigbluebuttonbn.participantData[e];if(e!="all"&&typeof r.children[t]=="undefined"){this.participantRemoveFromMemory(e,t);continue}this.participantAddToForm(e,t,n,i>0)}this.participantListUpdate()},participantListClear:function(){var e,t;e=document.getElementById("participant_list_table"),t=e.getElementsByTagName("tr");for(var n=t.length;n>0;n--)e.deleteRow(0)},participantListUpdate:function(){var e=document.getElementsByName("participants")[0];e.value=JSON.stringify(this.bigbluebuttonbn.participantList).replace(/"/g,"&quot;")},participantRemove:function(e,t){this.participantRemoveFromMemory(e,t),this.participantRemoveFromForm(e,t),this.participantListUpdate()},participantRemoveFromMemory:function(e,t){var n=t===""?null:t;for(var r=0;r<this.bigbluebuttonbn.participantList.length;r++)this.bigbluebuttonbn.participantList[r].selectiontype==e&&this.bigbluebuttonbn.participantList[r].selectionid==n&&this.bigbluebuttonbn.participantList.splice(r,1)},participantRemoveFromForm:function(e,t){var n="participant_list_tr_"+e+"-"+t,r=document.getElementById("participant_list_table");for(var i=0;i<r.rows.length;i++)r.rows[i].id==n&&r.deleteRow(i)},participantAdd:function(){var e=document.getElementById("bigbluebuttonbn_participant_selection_type"),t=document.getElementById("bigbluebuttonbn_participant_selection");for(var n=0;n<this.bigbluebuttonbn.participantList.length;n++)if(this.bigbluebuttonbn.participantList[n].selectiontype==e.value&&this.bigbluebuttonbn.participantList[n].selectionid==t.value)return;this.participantAddToMemory(e.value,t.value),this.participantAddToForm(e.value,t.value,"viewer",!0),this.participantListUpdate()},participantAddToMemory:function(e,t){this.bigbluebuttonbn.participantList.push({selectiontype:e,selectionid:t,role:"viewer"})},participantAddToForm:function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d,v;i=document.getElementById("participant_list_table"),c=i.insertRow(i.rows.length),c.id="participant_list_tr_"+e+"-"+t,h=c.insertCell(0),h.width="125px",h.innerHTML="<b><i>"+this.bigbluebuttonbn.participantData[e].name,h.innerHTML+=(e!=="all"?":&nbsp;":"")+"</i></b>",p=c.insertCell(1),p.innerHTML="",e!=="all"&&(p.innerHTML=this.bigbluebuttonbn.participantData[e].children[t].name),s="&nbsp;<i>"+this.strings.as+"</i>&nbsp;",s+='<select id="participant_list_role_'+e+"-"+t+'"',s+=" onchange=\"M.mod_bigbluebuttonbn.modform.participantListRoleUpdate('",s+=e+"', '"+t,s+='\'); return 0;" class="select custom-select">',f=["viewer","moderator"];for(l=0;l<f.length;l++
)o="",f[l]===n&&(o=' selected="selected"'),s+='<option value="'+f[l]+'"'+o+">"+this.strings[f[l]]+"</option>";s+="</select>",d=c.insertCell(2),d.innerHTML=s,v=c.insertCell(3),v.width="20px",u=this.strings.remove,a="btn btn-secondary btn-sm",this.bigbluebuttonbn.iconsEnabled&&(u=this.bigbluebuttonbn.pixIconDelete,a="btn btn-link"),s="",r&&(s='<a class="'+a+'" onclick="M.mod_bigbluebuttonbn.modform.participantRemove(\'',s+=e+"', '"+t,s+='\'); return 0;" title="'+this.strings.remove+'">'+u+"</a>"),v.innerHTML=s},participantListRoleUpdate:function(e,t){var n=document.getElementById("participant_list_role_"+e+"-"+t);for(var r=0;r<this.bigbluebuttonbn.participantList.length;r++)this.bigbluebuttonbn.participantList[r].selectiontype==e&&this.bigbluebuttonbn.participantList[r].selectionid==(t===""?null:t)&&(this.bigbluebuttonbn.participantList[r].role=n.value);this.participantListUpdate()},selectClear:function(e){var t=document.getElementById(e);while(t.length>0)t.remove(t.length-1)},selectEnable:function(e){var t=document.getElementById(e);t.disabled=!1},selectDisable:function(e){var t=document.getElementById(e);t.disabled=!0},selectAddOption:function(e,t,n){var r=document.getElementById(e),i=document.createElement("option");i.text=t,i.value=n,r.add(i,i.length)}}},"@VERSION@",{requires:["base","node"]});
